---
title: "Road accidents"
author: "Selim Ach"
date: "10/15/2020"
output:
  pdf_document: default
  html_document: default
---

The data that is analyzed in this report is related to road accidents occuring in Geneva. These type of data are usually presented in a table, but there are better ways, such as using maps.

```{r, warning =FALSE, message=FALSE, echo = FALSE}

# loading library

library(readr)
library(OpenStreetMap)
library(tidyverse)
library(visdat)
library(ggthemes)
library(kableExtra)

accidents <- read_csv("Data/accidents_Geneva.csv")

accidents_extr <- accidents %>% 
  head(15) %>% 
  select(date,groupe_accident,commune,conditions_meteo)

knitr::kable(accidents_extr, caption = "Extract of the information on road accidents in Geneva")

```

Since the information on longitude and lattitude is available, it is possible to plot on a graph the exact location of each accident. 

```{r, warning =FALSE, message=FALSE, echo = FALSE}

ggplot() +
  geom_point(
    data = accidents,
    mapping = aes(x = lon_wgs, y = lat_wgs),
    alpha = 0.05,
    color = "dodgerblue4"
  ) +
  theme_minimal() +
  labs(
    y = "Latitude",
    x = "Longitude",
    title = "Road accidents in Geneva",
    subtitle = "From 2010 to 2018",
    caption = "Source: SITG"
  )

```

```{r, warning =FALSE, message=FALSE, echo = FALSE}

map <- OpenStreetMap::openmap(
  upperLeft = c(46.183158, 6.107025),
  lowerRight = c(46.228066, 6.195431),
  type = "osm")

map_latlon <- openproj(map, projection = "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs")

autoplot.OpenStreetMap(map_latlon) +
  geom_point(
    data = accidents,
    mapping = aes(x = lon_wgs, y = lat_wgs),
    alpha = 0.05,
    color = "dodgerblue4"
  ) +
  labs(
    title = "Road accidents in Geneva",
    y = "Latitude",
    x = "Longitude",
    caption = "Source: SITG"
  ) +
  ylim(46.183158, 46.228066) +
  xlim(6.107025, 6.195431)+
  theme_void()+
    theme(plot.title = element_text(size = 14,hjust = 0.8, vjust = 1.5))
```
An extra layer with Geneva map is added on top of the location.

```{r, warning =FALSE, message=FALSE, echo = FALSE}

weather <- c("Beau temps","chute de neige","GrÃªle","Pluie","Pluie givrante",
      "Temps couvert")

accidents_filter <- accidents %>% 
  filter (conditions_meteo %in%weather)

autoplot.OpenStreetMap(map_latlon) +
  geom_point(
    data = accidents_filter,
    mapping = aes(x = lon_wgs, y = lat_wgs),
    alpha = 0.1,
    color = "dodgerblue4"
  ) +
  facet_wrap(vars(conditions_meteo))+
  labs(
    title = "Road accidents in Geneva",
    y = "Latitude",
    x = "Longitude",
    caption = "Source: SITG"
  ) +
  ylim(46.183158, 46.228066) +
  xlim(6.107025, 6.195431)+
  theme_void()+
    theme(plot.title = element_text(size = 14,hjust = 0.8, vjust = 1.5))
  
```

This map shows the location of all car accidents in Geneva. But are there more accidents during a rainy day ? The answer is in the chart !
